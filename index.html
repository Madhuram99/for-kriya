<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A cute Valentine's Day page to ask someone to be your Valentine!">
  <meta name="theme-color" content="#1a0a2e">
  <title>for kriya ðŸ’Œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Quicksand', sans-serif; }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a0a2e 0%, #2d1b69 25%, #44107a 50%, #893168 75%, #ff6b9d 100%);
      background-size: 400% 400%;
      animation: gradientShift 8s ease infinite;
      overflow: hidden;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Floating emojis */
    .floater {
      position: fixed;
      font-size: 1.5rem;
      opacity: 0.3;
      pointer-events: none;
      animation: floatUp linear infinite;
      z-index: 0;
    }
    @keyframes floatUp {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 0.3; }
      90% { opacity: 0.3; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
    }

    /* Glass card */
    .glass-card {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 24px;
      padding: 2.5rem 2rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), inset 0 0 80px rgba(255, 105, 180, 0.05);
      position: relative;
      z-index: 1;
    }

    /* Image glow */
    #imageDisplay {
      border-radius: 20px;
      border: 3px solid rgba(255, 105, 180, 0.4);
      box-shadow: 0 0 30px rgba(255, 105, 180, 0.3), 0 0 60px rgba(147, 51, 234, 0.15);
      transition: transform 0.3s ease;
    }
    #imageDisplay:hover { transform: scale(1.02); }

    /* Gradient text */
    .gradient-text {
      background: linear-gradient(135deg, #ff6b9d, #c084fc, #ff6b9d, #fb7185);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: textShimmer 3s ease infinite;
    }
    @keyframes textShimmer {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Yes button - pill shaped, glowy */
    #yesButton {
      background: linear-gradient(135deg, #ff6b9d, #c084fc);
      border: none;
      border-radius: 50px;
      color: white;
      font-weight: 700;
      letter-spacing: 0.5px;
      box-shadow: 0 0 20px rgba(255, 107, 157, 0.4), 0 0 40px rgba(192, 132, 252, 0.2);
      animation: yesGlow 2s ease infinite, bounce 2s ease infinite;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    #yesButton:hover {
      box-shadow: 0 0 30px rgba(255, 107, 157, 0.6), 0 0 60px rgba(192, 132, 252, 0.4);
      transform: scale(1.05);
    }
    @keyframes yesGlow {
      0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 157, 0.4), 0 0 40px rgba(192, 132, 252, 0.2); }
      50% { box-shadow: 0 0 30px rgba(255, 107, 157, 0.6), 0 0 60px rgba(192, 132, 252, 0.4); }
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-12px); }
      60% { transform: translateY(-6px); }
    }

    /* No button - smol, slay-proof */
    #noButton {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50px;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 600;
      cursor: pointer;
      position: relative;
      transition: transform 0.2s ease;
    }

    /* Sparkle cursor trail */
    .sparkle {
      position: fixed;
      pointer-events: none;
      font-size: 1rem;
      z-index: 99;
      animation: sparkleOut 0.8s ease forwards;
    }
    @keyframes sparkleOut {
      0% { transform: scale(1) rotate(0deg); opacity: 1; }
      100% { transform: scale(0) rotate(180deg) translateY(-30px); opacity: 0; }
    }

    /* Wrapped slideshow */
    .wrapped-overlay {
      position: fixed;
      inset: 0;
      z-index: 50;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.6s;
    }
    .wrapped-overlay.active { opacity: 1; }

    .wrapped-bg {
      position: absolute;
      inset: 0;
      transition: background 1.2s ease;
    }

    /* Ghibli-style atmospheric layers */
    .ghibli-clouds {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }
    .ghibli-cloud {
      position: absolute;
      border-radius: 50%;
      filter: blur(40px);
      opacity: 0;
      animation: cloudDrift 8s ease-in-out infinite;
    }
    @keyframes cloudDrift {
      0%   { transform: translateX(0) scale(1); opacity: 0; }
      20%  { opacity: 0.15; }
      80%  { opacity: 0.15; }
      100% { transform: translateX(60px) scale(1.1); opacity: 0; }
    }

    /* Fireflies / dust motes */
    .ghibli-particles {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }
    .ghibli-particle {
      position: absolute;
      border-radius: 50%;
      opacity: 0;
      animation: fireflyFloat 6s ease-in-out infinite;
    }
    @keyframes fireflyFloat {
      0%   { transform: translate(0, 0) scale(0.5); opacity: 0; }
      15%  { opacity: 0.8; }
      50%  { transform: translate(var(--drift-x), var(--drift-y)) scale(1); opacity: 0.6; }
      85%  { opacity: 0.8; }
      100% { transform: translate(var(--drift-x2), var(--drift-y2)) scale(0.5); opacity: 0; }
    }

    /* Soft stars for night sky slide */
    .ghibli-star {
      position: absolute;
      border-radius: 50%;
      background: #fff;
      opacity: 0;
      animation: starTwinkle 3s ease-in-out infinite;
    }
    @keyframes starTwinkle {
      0%, 100% { opacity: 0.1; transform: scale(0.8); }
      50% { opacity: 0.9; transform: scale(1.2); }
    }

    /* Soft vignette overlay on slides */
    .ghibli-vignette {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.3) 100%);
    }

    .wrapped-slide {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.85);
      transition: opacity 0.5s ease, transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
      padding: 2rem;
      z-index: 1;
    }
    .wrapped-slide.show {
      opacity: 1;
      transform: scale(1);
    }

    /* Ken Burns: subtle zoom & pan on images */
    .wrapped-slide .img-wrapper {
      overflow: hidden;
      border-radius: 24px;
      border: 3px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 105, 180, 0.15);
      max-height: 55vh;
      max-width: 80vw;
    }
    .wrapped-slide img {
      max-height: 55vh;
      max-width: 80vw;
      object-fit: contain;
      display: block;
      animation: none;
    }
    .wrapped-slide.show img {
      animation: kenBurns 6s ease-in-out forwards;
    }
    @keyframes kenBurns {
      0%   { transform: scale(1) translate(0, 0); }
      100% { transform: scale(1.08) translate(-1%, -1%); }
    }

    /* Video in slideshow */
    .wrapped-slide video {
      max-height: 55vh;
      max-width: 80vw;
      object-fit: contain;
      display: block;
      border-radius: 24px;
    }

    /* Caption animations */
    .wrapped-slide .caption {
      color: #fff;
      font-size: 1.5rem;
      font-weight: 700;
      margin-top: 1.5rem;
      text-align: center;
      text-shadow: 0 2px 20px rgba(0, 0, 0, 0.6);
      letter-spacing: 0.3px;
      opacity: 0;
      transform: translateY(20px);
      transition: none;
    }
    .wrapped-slide.show .caption {
      animation: captionIn 0.7s 0.3s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    @keyframes captionIn {
      0%   { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    .wrapped-slide .subcaption {
      color: rgba(255, 255, 255, 0.45);
      font-size: 0.85rem;
      margin-top: 0.5rem;
      font-weight: 500;
      opacity: 0;
      transform: translateY(10px);
    }
    .wrapped-slide.show .subcaption {
      animation: captionIn 0.5s 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    /* Year label for each slide */
    .wrapped-slide .year-label {
      color: rgba(255, 255, 255, 0.3);
      font-size: 4rem;
      font-weight: 700;
      position: absolute;
      top: 4rem;
      left: 50%;
      transform: translateX(-50%);
      letter-spacing: 6px;
      opacity: 0;
    }
    .wrapped-slide.show .year-label {
      animation: yearFade 0.8s 0.1s ease forwards;
    }
    @keyframes yearFade {
      0%   { opacity: 0; transform: translateX(-50%) scale(0.8); }
      100% { opacity: 0.15; transform: translateX(-50%) scale(1); }
    }

    .wrapped-progress-container {
      position: fixed;
      top: 1rem;
      left: 1rem;
      right: 1rem;
      display: flex;
      gap: 4px;
      z-index: 60;
    }
    .wrapped-progress-segment {
      flex: 1;
      height: 3px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      overflow: hidden;
    }
    .wrapped-progress-fill {
      height: 100%;
      background: #fff;
      width: 0%;
      border-radius: 2px;
      transition: none;
    }
    .wrapped-progress-segment.done .wrapped-progress-fill { width: 100%; }
    .wrapped-progress-segment.filling .wrapped-progress-fill {
      width: 100%;
      transition: width linear;
    }

    .wrapped-tap-hint {
      position: fixed;
      bottom: 2rem;
      color: rgba(255, 255, 255, 0.35);
      font-size: 0.85rem;
      font-weight: 600;
      z-index: 60;
      letter-spacing: 1px;
      text-transform: uppercase;
      animation: tapPulse 2s ease infinite;
    }
    @keyframes tapPulse {
      0%, 100% { opacity: 0.35; }
      50% { opacity: 0.7; }
    }

    /* Final slide special styles */
    .final-heart {
      font-size: 5rem;
      margin-bottom: 1rem;
      filter: drop-shadow(0 0 30px rgba(255, 107, 157, 0.6));
      animation: heartPulse 1.2s ease infinite;
    }
    @keyframes heartPulse {
      0%, 100% { transform: scale(1); }
      15% { transform: scale(1.15); }
      30% { transform: scale(1); }
      45% { transform: scale(1.1); }
      60% { transform: scale(1); }
    }
    .final-title {
      color: #fff;
      font-size: 2.2rem;
      font-weight: 700;
      text-align: center;
      line-height: 1.4;
      background: linear-gradient(135deg, #fff, #f9a8d4, #fff);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: textShimmer 3s ease infinite;
    }
    .final-subtitle {
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.1rem;
      margin-top: 1rem;
      font-style: italic;
      opacity: 0;
      transform: translateY(15px);
    }
    .wrapped-slide.show .final-subtitle {
      animation: captionIn 0.7s 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    .final-sign-off {
      color: rgba(255, 255, 255, 0.35);
      font-size: 0.85rem;
      margin-top: 1.5rem;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      opacity: 0;
    }
    .wrapped-slide.show .final-sign-off {
      animation: captionIn 0.6s 1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    /* Floating hearts on final slide */
    .final-floating-heart {
      position: absolute;
      font-size: 1.2rem;
      opacity: 0;
      pointer-events: none;
      animation: floatHeart 4s ease-in-out infinite;
    }
    @keyframes floatHeart {
      0% { transform: translateY(0) scale(0.8); opacity: 0; }
      20% { opacity: 0.4; }
      80% { opacity: 0.4; }
      100% { transform: translateY(-100px) scale(1.2); opacity: 0; }
    }

    /* Replay button on final slide */
    .replay-btn {
      margin-top: 2rem;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50px;
      color: rgba(255, 255, 255, 0.6);
      font-family: 'Quicksand', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      padding: 0.5rem 1.5rem;
      cursor: pointer;
      letter-spacing: 1px;
      opacity: 0;
      transition: all 0.3s ease;
    }
    .wrapped-slide.show .replay-btn {
      animation: captionIn 0.5s 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    .replay-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
    }

    /* subtext under question */
    .subtext {
      color: rgba(255, 255, 255, 0.4);
      font-size: 0.85rem;
      font-weight: 500;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
  </style>
  <!-- Preload images -->
  <link rel="preload" as="image" href="./images/image1.gif">
  <link rel="preload" as="image" href="./images/image2.gif">
  <link rel="preload" as="image" href="./images/image3.gif">
  <link rel="preload" as="image" href="./images/image4.gif">
  <link rel="preload" as="image" href="./images/image5.gif">
  <link rel="preload" as="image" href="./images/image6.gif">
  <link rel="preload" as="image" href="./images/image7.gif">
</head>
<body>
  <!-- Background music -->
  <audio id="bgMusic" loop preload="auto">
    <source src="./Die With A Smile-(SambalpuriStar.In).mp3" type="audio/mpeg">
  </audio>

  <!-- Floating emoji background -->
  <div id="floaters"></div>

  <main class="flex items-center justify-center h-screen relative z-10">
    <section class="glass-card flex flex-col items-center max-w-md mx-4">
      <img
        id="imageDisplay"
        src="./images/image1.gif"
        alt="Hello Kitty with hearts"
        class="h-[260px] w-auto object-contain"
      />
      <p class="subtext mt-4 mb-1">âœ¨ for the prettiest girl i know âœ¨</p>
      <h1 id="valentineQuestion" class="text-3xl font-bold gradient-text text-center my-2 leading-snug">
        Kriya, will you be my Valentine?
      </h1>
      <div id="responseButtons" class="flex gap-5 pt-6 items-center">
        <button
          id="yesButton"
          class="text-xl px-8 py-3 min-w-[100px]"
        >
          yes pls ðŸ’—
        </button>
        <button
          id="noButton"
          class="text-base px-5 py-2 min-w-[70px]"
        >
          No
        </button>
      </div>
    </section>
  </main>

  <script>
    (() => {
      // ---- BACKGROUND MUSIC (always on, no mute) ----
      const bgMusic = document.getElementById('bgMusic');
      bgMusic.volume = 0.5;

      function startMusic() {
        bgMusic.play().catch(() => {});
      }

      // Start music on first interaction (browsers require it)
      function onFirstInteraction() {
        startMusic();
        document.removeEventListener('click', onFirstInteraction);
        document.removeEventListener('touchstart', onFirstInteraction);
      }
      document.addEventListener('click', onFirstInteraction);
      document.addEventListener('touchstart', onFirstInteraction);

      // ---- FLOATING EMOJIS ----
      const emojis = ['ðŸ’—', 'âœ¨', 'ðŸ¦‹', 'ðŸ’Œ', 'ðŸŒ¸', 'ðŸ’•', 'â­', 'ðŸŽ€', 'ðŸ’œ', 'ðŸ©·'];
      const floaterContainer = document.getElementById('floaters');
      function spawnFloater() {
        const el = document.createElement('div');
        el.className = 'floater';
        el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.animationDuration = (8 + Math.random() * 12) + 's';
        el.style.fontSize = (1 + Math.random() * 1.5) + 'rem';
        floaterContainer.appendChild(el);
        el.addEventListener('animationend', () => el.remove());
      }
      // Spawn initial batch
      for (let i = 0; i < 15; i++) setTimeout(spawnFloater, i * 300);
      setInterval(spawnFloater, 800);

      // ---- SPARKLE CURSOR ----
      let lastSparkle = 0;
      document.addEventListener('mousemove', (e) => {
        if (Date.now() - lastSparkle < 100) return;
        lastSparkle = Date.now();
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.textContent = ['âœ¨', 'ðŸ’—', 'â­', 'ðŸ©·'][Math.floor(Math.random() * 4)];
        sparkle.style.left = e.clientX + 'px';
        sparkle.style.top = e.clientY + 'px';
        document.body.appendChild(sparkle);
        sparkle.addEventListener('animationend', () => sparkle.remove());
      });

      // ---- DOM REFS ----
      const yesButton = document.getElementById('yesButton');
      const noButton = document.getElementById('noButton');
      const imageDisplay = document.getElementById('imageDisplay');
      const valentineQuestion = document.getElementById('valentineQuestion');
      const responseButtons = document.getElementById('responseButtons');

      const GROWTH_PER_CLICK = 35;
      const FONT_GROWTH_PER_CLICK = 25;
      const MAX_NO_CLICKS = 5;

      const IMAGE_PATHS = [
        './images/image1.gif',
        './images/image2.gif',
        './images/image3.gif',
        './images/image4.gif',
        './images/image5.gif',
        './images/image6.gif',
        './images/image7.gif',
      ];

      const NO_BUTTON_MESSAGES = [
        'No',
        'Kriya are you sure? ðŸ¥º',
        'Pookie please',
        "Kriya don't do this to me :(",
        "You're breaking my heart ðŸ’”",
        "I'm gonna cry Kriya...",
      ];

      const ALT_TEXTS = [
        'Hello Kitty with hearts',
        'Hello Kitty saying pretty please',
        'Hello Kitty begging with hearts',
        'Sad Hello Kitty with falling stars',
        'Hello Kitty crying',
        'Hello Kitty shedding tears',
        'Hello Kitty celebrating yay',
      ];

      const WRAPPED_SLIDES = [
        { type: 'image', src: './images/WhatsApp Image 2026-02-13 at 02.20.43.jpeg' },
        { type: 'image', src: './images/WhatsApp Image 2026-02-13 at 02.20.43 (1).jpeg' },
        { type: 'image', src: './images/WhatsApp Image 2026-02-13 at 02.24.16.jpeg' },
        { type: 'video', src: './images/WhatsApp Video 2026-02-13 at 03.36.16.mp4' },
      ];

      const WRAPPED_CAPTIONS = [
        "cute since day one, no debate ðŸ’—",
        "giving main character energy since forever ðŸ« ",
        "and then you grew up and chose violence ðŸ’•",
        "those kajal eyes & that smile? nobody stood a chance ðŸ« ",
      ];

      // Ghibli-inspired dreamy backgrounds
      const WRAPPED_GRADIENTS = [
        // Slide 1: Spirited Away sunset â€” warm peach, lavender, rose
        'linear-gradient(180deg, #2d1b4e 0%, #6b3a7d 20%, #c97b8b 50%, #f4a582 75%, #fdd6b0 100%)',
        // Slide 2: Howl's Moving Castle sky â€” soft blue, cloud white, gentle violet
        'linear-gradient(180deg, #1a2a5e 0%, #3a6fa0 25%, #7db8d4 50%, #c7dff0 75%, #e8d5e0 100%)',
        // Slide 3: Grave of the Fireflies night â€” deep indigo, midnight blue, starlight
        'linear-gradient(180deg, #0a0e23 0%, #131b3a 25%, #1e2952 50%, #2a3a6b 75%, #3d4f7c 100%)',
        // Slide 4 (video): Mononoke forest â€” emerald, golden firefly glow
        'linear-gradient(180deg, #0a1a12 0%, #14332a 25%, #1a4d3a 50%, #2d6b4f 75%, #4a8b5c 100%)',
        // Final: Magical aurora â€” pink, lavender, celestial
        'linear-gradient(180deg, #1a0a2e 0%, #3d1d6b 25%, #7b4a9e 50%, #c97ba8 75%, #f0b6c8 100%)',
      ];

      // Ghibli themes per slide â€” controls particle colors and type
      const GHIBLI_THEMES = [
        { type: 'sunset', colors: ['#fdd6b0', '#f4a582', '#e8917a', '#ffcc99'] },
        { type: 'clouds', colors: ['#c7dff0', '#a8c8e0', '#e0e8f0', '#f0f0ff'] },
        { type: 'stars', colors: ['#ffffff', '#c0d0ff', '#a0b0e0', '#e0e0ff'] },
        { type: 'fireflies', colors: ['#d4e85e', '#a8d840', '#f0e68c', '#7dcd5e'] },
        { type: 'magic', colors: ['#f9a8d4', '#c084fc', '#ff6b9d', '#e0b0ff'] },
      ];

      let noClickCount = 0;
      let buttonHeight = 48;
      let buttonWidth = 100;
      let fontSize = 20;

      // ---- NO BUTTON DODGE (uses transform, stays in place, with cooldown) ----
      let dodgeCount = 0;
      let offsetX = 0;
      let offsetY = 0;
      let dodgeCooldown = false;

      function dodgeNoButton() {
        if (dodgeCooldown) return;
        dodgeCooldown = true;
        setTimeout(() => { dodgeCooldown = false; }, 300);

        // Pick a random nudge direction
        const directions = [
          { x: 150, y: 0 }, { x: -150, y: 0 },
          { x: 0, y: 100 }, { x: 0, y: -100 },
          { x: 100, y: -80 }, { x: -100, y: -80 },
          { x: 100, y: 80 }, { x: -100, y: 80 },
        ];
        const dir = directions[Math.floor(Math.random() * directions.length)];
        offsetX += dir.x;
        offsetY += dir.y;

        // Keep within reasonable bounds from original spot
        offsetX = Math.max(-300, Math.min(300, offsetX));
        offsetY = Math.max(-250, Math.min(250, offsetY));

        noButton.style.transform = `translate(${offsetX}px, ${offsetY}px)`;

        // Change Hello Kitty image on each dodge
        dodgeCount++;
        const imgIndex = Math.min(dodgeCount, IMAGE_PATHS.length - 2);
        imageDisplay.src = IMAGE_PATHS[imgIndex];
        imageDisplay.alt = ALT_TEXTS[imgIndex];

        // Grow yes button & update no text
        if (dodgeCount <= MAX_NO_CLICKS) {
          buttonHeight += GROWTH_PER_CLICK;
          buttonWidth += GROWTH_PER_CLICK;
          fontSize += FONT_GROWTH_PER_CLICK;
          yesButton.style.height = `${buttonHeight}px`;
          yesButton.style.width = `${buttonWidth}px`;
          yesButton.style.fontSize = `${fontSize}px`;
          noButton.textContent = NO_BUTTON_MESSAGES[Math.min(dodgeCount, NO_BUTTON_MESSAGES.length - 1)];
        }
      }

      // Desktop: dodge on hover
      noButton.addEventListener('mouseenter', dodgeNoButton);

      // Mobile: intercept touch and dodge instead of clicking
      noButton.addEventListener('touchstart', (e) => {
        e.preventDefault();
        dodgeNoButton();
      }, { passive: false });

      // ---- YES â†’ WRAPPED ----
      yesButton.addEventListener('click', () => {
        imageDisplay.src = IMAGE_PATHS[IMAGE_PATHS.length - 1];
        imageDisplay.alt = ALT_TEXTS[ALT_TEXTS.length - 1];
        valentineQuestion.innerHTML = 'YAAYYY KRIYA!! ðŸŽ‰';
        const sub = document.querySelector('.subtext');
        if (sub) sub.textContent = "i knew you'd say yes ðŸ¥¹";
        responseButtons.style.display = 'none';

        const heart = confetti.shapeFromPath({
          path: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z',
        });
        const defaults = { spread: 360, ticks: 100, gravity: 0, decay: 0.94, startVelocity: 20, shapes: [heart], colors: ['#ff6b9d', '#c084fc', '#fb7185', '#a78bfa', '#f9a8d4'] };
        confetti({ ...defaults, particleCount: 50, scalar: 2 });
        confetti({ ...defaults, particleCount: 25, scalar: 3 });
        confetti({ ...defaults, particleCount: 10, scalar: 4 });

        // Preload slideshow media during YAAYYY screen
        WRAPPED_SLIDES.forEach(s => {
          if (s.type === 'image') { new Image().src = s.src; }
        });

        setTimeout(startWrapped, 3500);
      });

      // ---- GHIBLI PARTICLE SYSTEM ----
      function spawnGhibliParticles(container, theme) {
        const count = theme.type === 'stars' ? 40 : 20;

        for (let i = 0; i < count; i++) {
          const p = document.createElement('div');

          if (theme.type === 'stars') {
            p.className = 'ghibli-star';
            const size = 1 + Math.random() * 3;
            p.style.width = size + 'px';
            p.style.height = size + 'px';
            p.style.left = (Math.random() * 100) + '%';
            p.style.top = (Math.random() * 60) + '%';
            p.style.animationDelay = (Math.random() * 3) + 's';
            p.style.animationDuration = (2 + Math.random() * 3) + 's';
            p.style.boxShadow = `0 0 ${size * 2}px ${theme.colors[i % theme.colors.length]}`;
          } else if (theme.type === 'fireflies') {
            p.className = 'ghibli-particle';
            const size = 3 + Math.random() * 5;
            p.style.width = size + 'px';
            p.style.height = size + 'px';
            p.style.left = (10 + Math.random() * 80) + '%';
            p.style.top = (20 + Math.random() * 60) + '%';
            p.style.background = theme.colors[i % theme.colors.length];
            p.style.boxShadow = `0 0 ${size * 3}px ${theme.colors[i % theme.colors.length]}, 0 0 ${size * 6}px ${theme.colors[i % theme.colors.length]}40`;
            p.style.setProperty('--drift-x', (Math.random() * 60 - 30) + 'px');
            p.style.setProperty('--drift-y', (Math.random() * 40 - 20) + 'px');
            p.style.setProperty('--drift-x2', (Math.random() * 80 - 40) + 'px');
            p.style.setProperty('--drift-y2', (Math.random() * 60 - 50) + 'px');
            p.style.animationDelay = (Math.random() * 4) + 's';
            p.style.animationDuration = (4 + Math.random() * 4) + 's';
          } else {
            // sunset, clouds, magic â€” soft floating orbs
            p.className = 'ghibli-particle';
            const size = 4 + Math.random() * 6;
            p.style.width = size + 'px';
            p.style.height = size + 'px';
            p.style.left = (5 + Math.random() * 90) + '%';
            p.style.top = (10 + Math.random() * 80) + '%';
            const color = theme.colors[i % theme.colors.length];
            p.style.background = color;
            p.style.boxShadow = `0 0 ${size * 2}px ${color}80`;
            p.style.setProperty('--drift-x', (Math.random() * 40 - 20) + 'px');
            p.style.setProperty('--drift-y', (-20 - Math.random() * 30) + 'px');
            p.style.setProperty('--drift-x2', (Math.random() * 60 - 30) + 'px');
            p.style.setProperty('--drift-y2', (-40 - Math.random() * 40) + 'px');
            p.style.animationDelay = (Math.random() * 5) + 's';
            p.style.animationDuration = (5 + Math.random() * 5) + 's';
          }

          container.appendChild(p);
        }

        // Add soft cloud blobs for depth on certain themes
        if (theme.type === 'sunset' || theme.type === 'clouds' || theme.type === 'magic') {
          for (let i = 0; i < 4; i++) {
            const cloud = document.createElement('div');
            cloud.className = 'ghibli-cloud';
            const size = 150 + Math.random() * 200;
            cloud.style.width = size + 'px';
            cloud.style.height = (size * 0.5) + 'px';
            cloud.style.left = (Math.random() * 80) + '%';
            cloud.style.top = (5 + Math.random() * 30) + '%';
            cloud.style.background = theme.colors[i % theme.colors.length];
            cloud.style.animationDelay = (Math.random() * 6) + 's';
            cloud.style.animationDuration = (6 + Math.random() * 6) + 's';
            container.appendChild(cloud);
          }
        }
      }

      // ---- SPOTIFY WRAPPED SLIDESHOW ----
      const SLIDE_DURATION = 5000; // 5 seconds per slide auto-advance
      const WRAPPED_YEARS = ['', '', '', ''];

      function startWrapped() {
        const overlay = document.createElement('div');
        overlay.className = 'wrapped-overlay';

        const bg = document.createElement('div');
        bg.className = 'wrapped-bg';
        overlay.appendChild(bg);

        // Ghibli atmospheric layers container
        const ghibliLayer = document.createElement('div');
        ghibliLayer.className = 'ghibli-particles';
        overlay.appendChild(ghibliLayer);

        const ghibliVignette = document.createElement('div');
        ghibliVignette.className = 'ghibli-vignette';
        overlay.appendChild(ghibliVignette);

        // Story-style segmented progress bar
        const progressContainer = document.createElement('div');
        progressContainer.className = 'wrapped-progress-container';
        const totalSlides = WRAPPED_SLIDES.length + 1;
        const segments = [];
        for (let i = 0; i < totalSlides; i++) {
          const seg = document.createElement('div');
          seg.className = 'wrapped-progress-segment';
          const fill = document.createElement('div');
          fill.className = 'wrapped-progress-fill';
          seg.appendChild(fill);
          progressContainer.appendChild(seg);
          segments.push({ seg, fill });
        }

        const tapHint = document.createElement('div');
        tapHint.className = 'wrapped-tap-hint';
        tapHint.textContent = 'tap to continue â†’';

        overlay.appendChild(progressContainer);
        overlay.appendChild(tapHint);

        // Create slides (image or video)
        const slides = WRAPPED_SLIDES.map((media, i) => {
          const slide = document.createElement('div');
          slide.className = 'wrapped-slide';

          // Year label in background
          if (WRAPPED_YEARS[i]) {
            const yearLabel = document.createElement('div');
            yearLabel.className = 'year-label';
            yearLabel.textContent = WRAPPED_YEARS[i];
            slide.appendChild(yearLabel);
          }

          if (media.type === 'video') {
            const imgWrapper = document.createElement('div');
            imgWrapper.className = 'img-wrapper';
            const vid = document.createElement('video');
            vid.src = media.src;
            vid.muted = true;
            vid.playsInline = true;
            vid.loop = true;
            vid.setAttribute('playsinline', '');
            vid.setAttribute('webkit-playsinline', '');
            imgWrapper.appendChild(vid);
            slide.appendChild(imgWrapper);
            slide._video = vid;
          } else {
            const imgWrapper = document.createElement('div');
            imgWrapper.className = 'img-wrapper';
            const img = document.createElement('img');
            img.src = media.src;
            img.alt = `Photo of Kriya ${i + 1}`;
            imgWrapper.appendChild(img);
            slide.appendChild(imgWrapper);
          }

          const caption = document.createElement('div');
          caption.className = 'caption';
          caption.textContent = WRAPPED_CAPTIONS[i];
          const subcaption = document.createElement('div');
          subcaption.className = 'subcaption';
          subcaption.textContent = `${i + 1} of ${WRAPPED_SLIDES.length}`;
          slide.appendChild(caption);
          slide.appendChild(subcaption);
          overlay.appendChild(slide);
          return slide;
        });

        // Final slide - much more impactful
        const finalSlide = document.createElement('div');
        finalSlide.className = 'wrapped-slide';
        finalSlide.innerHTML = `
          <div class="final-heart">ðŸ’—</div>
          <div class="final-title">
            Happy Valentine's Day, Kriya
          </div>
          <div class="final-subtitle">you were always the prettiest person in every room ðŸ¥¹</div>
          <div class="final-sign-off">â€” yours, always ðŸ’Œ</div>
          <button class="replay-btn" id="replayBtn">watch again â†»</button>
        `;
        // Add floating hearts to final slide
        const heartEmojis = ['ðŸ’—', 'ðŸ’•', 'ðŸ©·', 'ðŸ’œ', 'ðŸŒ¸'];
        for (let i = 0; i < 12; i++) {
          const fh = document.createElement('div');
          fh.className = 'final-floating-heart';
          fh.textContent = heartEmojis[i % heartEmojis.length];
          fh.style.left = (10 + Math.random() * 80) + '%';
          fh.style.top = (20 + Math.random() * 60) + '%';
          fh.style.animationDelay = (Math.random() * 4) + 's';
          fh.style.animationDuration = (3 + Math.random() * 3) + 's';
          fh.style.fontSize = (0.8 + Math.random() * 1) + 'rem';
          finalSlide.appendChild(fh);
        }
        overlay.appendChild(finalSlide);
        slides.push(finalSlide);

        document.body.appendChild(overlay);
        requestAnimationFrame(() => overlay.classList.add('active'));

        let current = 0;
        let autoTimer = null;

        function showSlide(index) {
          // Clear any pending auto-advance
          if (autoTimer) { clearTimeout(autoTimer); autoTimer = null; }

          // Pause any playing videos & reset all slides
          slides.forEach(s => {
            s.classList.remove('show');
            if (s._video) { s._video.pause(); s._video.currentTime = 0; }
          });
          slides[index].classList.add('show');
          // Auto-play video if this slide has one
          if (slides[index]._video) {
            slides[index]._video.play().catch(() => {});
          }
          bg.style.background = WRAPPED_GRADIENTS[index % WRAPPED_GRADIENTS.length];

          // Spawn Ghibli particles for this slide
          ghibliLayer.innerHTML = '';
          const theme = GHIBLI_THEMES[index % GHIBLI_THEMES.length];
          spawnGhibliParticles(ghibliLayer, theme);

          // Update progress segments
          segments.forEach((s, i) => {
            s.seg.classList.remove('filling');
            if (i < index) {
              s.seg.classList.add('done');
              s.fill.style.width = '100%';
            } else {
              s.seg.classList.remove('done');
              s.fill.style.width = '0%';
            }
          });

          // Animate current segment fill over SLIDE_DURATION
          requestAnimationFrame(() => {
            const currentSeg = segments[index];
            currentSeg.fill.style.transitionDuration = (SLIDE_DURATION / 1000) + 's';
            currentSeg.seg.classList.add('filling');
          });

          // Heart confetti on each slide
          const heart = confetti.shapeFromPath({
            path: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z',
          });
          confetti({ particleCount: 15, spread: 360, gravity: 0, decay: 0.95, startVelocity: 12, shapes: [heart], colors: ['#ff6b9d', '#c084fc', '#fb7185', '#a78bfa'], scalar: 2 });

          if (index === slides.length - 1) {
            tapHint.style.display = 'none';
            // Big finale confetti burst
            setTimeout(() => {
              confetti({ particleCount: 80, spread: 360, gravity: 0, decay: 0.94, startVelocity: 25, shapes: [heart], colors: ['#ff6b9d', '#c084fc', '#fb7185', '#a78bfa', '#f9a8d4'], scalar: 3 });
            }, 300);
            setTimeout(() => {
              confetti({ particleCount: 40, spread: 360, gravity: 0, decay: 0.94, startVelocity: 18, shapes: [heart], colors: ['#ff6b9d', '#c084fc', '#fb7185'], scalar: 2.5 });
            }, 800);
            return;
          }

          // Auto-advance after SLIDE_DURATION
          autoTimer = setTimeout(() => {
            if (current < slides.length - 1) {
              current++;
              showSlide(current);
            }
          }, SLIDE_DURATION);
        }

        function nextSlide() {
          if (current < slides.length - 1) {
            current++;
            showSlide(current);
          }
        }

        overlay.addEventListener('click', (e) => {
          if (e.target.id === 'replayBtn') return;
          nextSlide();
        });

        // Replay button restarts from first slide
        finalSlide.querySelector('#replayBtn').addEventListener('click', (e) => {
          e.stopPropagation();
          current = 0;
          tapHint.style.display = '';
          tapHint.textContent = 'tap to continue â†’';
          showSlide(0);
        });

        setTimeout(() => showSlide(0), 100);
      }
    })();
  </script>
</body>
</html>
